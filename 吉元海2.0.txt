#include<reg52.h>				   
#include<intrins.h>
void delay(unsigned int c);
sbit led0=P1^0;
sbit led1=P1^1;
sbit led2=P1^2;
sbit led3=P1^3;
sbit led4=P1^4;	
sbit led5=P1^5;
sbit led6=P1^6;
sbit led7=P1^7;
void main()
{
	  unsigned char num=0,w=0,a=0,b=0,q=0,d=0,k=0;
	  int i=0,cnt=0,v=0,e=1,r=0;
	  P1=0xff;;
	  TMOD=0x01;
	  TH0=0xD8F0;
	  TL0=0x00;
	  TR0=1;
	  while(1)
	  {
		 if(TF0==1)
		 {
			TF0=0;
			TH0=0xD8F0;		//0.01s//10ms
			TL0=0x00;
			cnt++;				 //记录溢出多少次10ms
			w++;			////	第二次记录
			if(cnt>=10)	   //run 10times,,is 100ms
			{
			    cnt=0;
				w=0;
				P1=~P1;				//闪烁
				num++;			  //记录走了多少个100ms
			}	
			if(w>=30)		  ////闪烁间隔	30*10=300ms
			{
			   cnt=-30;
			   w=0;
			   P1=~P1;
			   d++;			//记录走了多少个300ms
			}
			if(d>=40)		////20*30=6000ms  因为写d>=20时明显不够6s所以改了一下
			{
			   d=0;	
			   for(e=1;e<=3;e++)	
			   {	
			     P1=0x01;	
			      for(v=0;v<8;v++)		 //流水灯
			     {
			       P1=_crol_(P1,1);
				   delay(20);
				   q++;
			     }
				 if(q>=24)
				 break;		
		    	}
			   break; 		 //这个有用不能删
			}		  
		    if(num>=40)	   //不到30*100ms=3000ms不走这个程序
		  {
		    num=0;
			a++;			//a=a+1	
			if(a>=1)
				{
			    	a=0;
					P1=0xFF;		//1111  1111  从右到左依次亮
					for(i=0;i<8;i++)
					{
						 delay(20);
					     P1>>=1; 		 
			    	} 
			     for(k=0;k<9;k++)			//从左到右依次灭
				 {
				   P1=~(0xff<<r);			  		  
				   delay(20);
				   r++;			  
				 }
				}
				P1=0X00;	  //常亮
				delay(150);
				P1=0XFF;		//长灭
				cnt=-30;
				r=0;   
				delay(100);		
		 }     
	    }//while		 
	  }
 }
void delay(unsigned int c)   
{
    unsigned char a, b;
 
    for (;c>0;c--)
	{
		for (b=38;b>0;b--)
		{
			for (a=130;a>0;a--);
		}       
	} 
}  